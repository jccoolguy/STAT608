---
title: "STAT 608 Homework 4"
author: "Jack Cunningham"
format: pdf
editor: visual
---

8\)

Loading Company Data

```{r}
company <- read.csv("company.csv")
attach(company)
```

a\)

```{r}
plot(x = Sales, y = Assets)
lines(lowess(Assets, Sales))
```

From this plot we can say that it appears Sales and Assets do not have a linear relationship. The upward curving trend towards the high leverage point in the top right of the plot suggest a log transformation would be reasonable.

```{r fig.width= 10, fig.height=10}
fit_1 <- lm(Assets ~ Sales)
par(mfrow = c(2,2))
plot(fit_1)
```

From the Residuals vs Fitted plot we can see that residuals do not appear to vary randomly around zero. For fitted values 0 to 20,000 residuals are below zero on average.

In the normal Q-Q plot we can see the standardized residuals don't appear normally distributed. Particularly the right tail is much longer and fatter than what would be expected by the theoretical normal distribution.

In the $|\sqrt{\text{std. residuals}}|$ by Fitted values plot we can see evidence of non-constant variance. The trend line has an upward slope for Fitted values 0 to 20,000 where most observations are found, then it has a downward slope.

b\)

```{r}
hist(Sales)
```

From the histogram of Sales we can see that the distribution is highly right skewed and would be poorly fit by the normal distribution. We can use the box-cox method to transform Sales. That is the below transformation:

$$
\Psi_S(X,\lambda)=\begin{cases} (X^\lambda-1)/\lambda & \text{if } \lambda \neq 0 \\ log(X) & \text{if }\lambda =0\end{cases}
$$

Then choosing between the below options for $\lambda$:

$$
\lambda:\{-1,-1/2,-1/3,-1/4,0,1/4,1/3,1/2,1\}
$$

```{r}
library(car)
summary(powerTransform(Sales))
```

The likelihood ratio test with $H_0: \text{Sales is normally distributed}$, $H_a: \text{Sales is not normally distributed}$ rejects the null hypothesis with a p value extremely close to zero. We need to transform Sales.

The estimated $\lambda$ found by the box-cox transformation is -0.0675. From the likelihood ratio test with $H_0:\lambda=0,H_a:\lambda \neq0$ we see that the null hypothesis cannot be rejected. Thus, we choose the log transformation of Sales.

```{r}
log_sales <- log(Sales)
```

c\)

```{r}
fit_2 <- lm(Assets ~ log_sales)
summary(powerTransform(fit_2))
```
